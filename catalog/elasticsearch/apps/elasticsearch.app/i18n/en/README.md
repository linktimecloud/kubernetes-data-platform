### 1. Introduction
Elasticsearch is a distributed search and analytics engine based on the Lucene library, widely used for full-text search, structured search, and analytics.

#### Basic Concepts
1. Index
Definition: An index is a collection of documents that have similar characteristics. It is analogous to a database in a relational database management system.
Operations: Indexes can be created, deleted, and modified.

2. Type
Definition: A type is a logical category/partition within an index that allows storing different types of documents in the same index. However, in Elasticsearch 6.x and later versions, an index can only have one type.
Note: Types have been removed in Elasticsearch 7.x and later versions.

3. Document
Definition: A document is the basic unit of information in Elasticsearch, represented in JSON format. It is analogous to a row in a relational database.
Operations: Documents can be added, deleted, updated, and queried.

4. Field
Definition: A field is an attribute of a document, similar to a column in a relational database.
Types: Fields can have different data types, such as string, integer, boolean, etc.

5. Mapping
Definition: Mapping defines the types of fields and their properties in an index, similar to the table schema in a relational database.
Operations: Mappings can be defined manually or automatically generated by Elasticsearch.

6. Query
Definition: A query is a request used to retrieve documents from Elasticsearch.
Types: Includes full-text queries, match queries, boolean queries, etc.

7. Aggregation
Definition: Aggregations are used to perform statistical and analytical operations on data, similar to GROUP BY and aggregate functions in SQL.
Types: Includes metric aggregations (e.g., average, sum) and bucket aggregations (e.g., range, date histogram).

8. Shard
Definition: A shard is a horizontal partition of an index, where each shard is an independent Lucene index.
Purpose: Shards allow horizontal scaling and parallel processing, improving performance and reliability.

9. Replica
Definition: A replica is a copy of a shard, used for high availability and fault tolerance.
Operations: The number of replicas can be adjusted dynamically.

10. Node
Definition: A node is a server in an Elasticsearch cluster that stores data and participates in the cluster's indexing and search operations.
Types: Includes master nodes, data nodes, coordinating nodes, etc.

11. Cluster
Definition: A cluster is a collection of nodes that collectively store the entire dataset and provide federated indexing and search capabilities.
Operations: Nodes can be added and removed dynamically.

12. Index Template
Definition: An index template defines the default settings and mappings for newly created indices.
Purpose: Simplifies the index creation process and ensures consistency.

13. Alias
Definition: An alias is a pointer to one or more indices, allowing index switching without modifying application code.
Operations: Aliases can be created, deleted, and updated.

14. Analyzer
Definition: An analyzer is used to convert text into tokens, including character filters, tokenizers, and token filters.
Purpose: Improves the accuracy and relevance of searches.

### 2. Quick Start

```bash

# Set environment variables
export ES_ENDPOINT=http://elasticsearch-kdp-data.kdp-e2e.io
export ES_INDEX=example-rest-curl-$(date +%s)

# Create an index
curl -X POST "${ES_ENDPOINT}/${ES_INDEX}/_doc?pretty" -H 'Content-Type: application/json' -d'
{
  "@timestamp": "2099-05-06T16:21:15.000Z",
  "event": {
    "original": "192.0.2.42 - - [06/May/2099:16:21:15 +0000] \"GET /images/bg.jpg HTTP/1.0\" 200 24736"
  }
}
'
# Get the mapping of an index
curl -X GET "${ES_ENDPOINT}/${ES_INDEX}/_mapping?pretty"

# Add multiple documents to an index
curl -X PUT "${ES_ENDPOINT}/${ES_INDEX}/_bulk?pretty" -H 'Content-Type: application/json' -d'
{ "create": { } }
{ "@timestamp": "2099-05-07T16:24:32.000Z", "event": { "original": "192.0.2.242 - - [07/May/2020:16:24:32 -0500] \"GET /images/hm_nbg.jpg HTTP/1.0\" 304 0" } }
{ "create": { } }
{ "@timestamp": "2099-05-08T16:25:42.000Z", "event": { "original": "192.0.2.255 - - [08/May/2099:16:25:42 +0000] \"GET /favicon.ico HTTP/1.0\" 200 3638" } }
'

# Search data in an index
curl -X GET "${ES_ENDPOINT}/${ES_INDEX}/_search?pretty" -H 'Content-Type: application/json' -d'
{
  "query": {
    "match": {
      "event.original": "favicon.ico"
    }
  }
}
'

#  Delete an index
curl -X DELETE "${ES_ENDPOINT}/${ES_INDEX}?pretty"

```

### 3. FAQ

1. Elasticsearch 有哪些常用 node role ?

- 主节点（Master-eligible Node）:有资格被选举为主节点的节点。主节点负责管理集群的状态，包括创建和删除索引、跟踪集群中的节点以及分配分片到节点等。
- 数据节点（Data Node）:负责存储数据并执行数据相关的操作，如搜索和聚合。数据节点处理与数据存储和查询相关的负载。
- 协调节点（Coordinating Node）:负责接收客户端请求，将请求分发到相应的数据节点，并收集结果返回给客户端。每个节点默认都是协调节点，但可以通过配置专门指定某些节点为协调节点。
- 摄取节点（Ingest Node）:负责执行预处理管道，对文档进行转换和 enrich 操作。摄取节点在索引文档之前对文档进行预处理。


> https://www.elastic.co/guide/en/elasticsearch/reference/8.14/troubleshooting.html

